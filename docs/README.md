<a href="https://bluzelle.com/"><img src='https://raw.githubusercontent.com/bluzelle/api/master/source/images/Bluzelle%20-%20Logo%20-%20Big%20-%20Colour.png' alt="Bluzelle" style="width: 100%"/></a>

Build Status (branch devel): [![Build Status](https://travis-ci.org/bluzelle/bluzelle-js.svg?branch=devel)](https://travis-ci.org/bluzelle/bluzelle-js)


**blzjs** is a JavaScript library that can be used to access the Bluzelle database service.

# blzjs API documentation

Read below for detailed documentation on how to use the Bluzelle database service.

{% hint style="info" %}
The Bluzelle JavaScript library works with [promises](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise) to model asynchronous behavior. Ensure that dependent calls to the Bluzelle database are within `.then()` blocks or within [asynchronous functions](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/async_function). Also ensure that promises exceptions are caught and handled.
{% endhint %}

{% hint style="info" %}
Keys and values in the Bluzelle database are plain strings to ensure compatibility for all forms of serialization. JavaScript applications will probably want to use `JSON.stringify(obj)` and `JSON.parse(str)` to convert object data to and from string format.
{% endhint %}

## Exports

### version (tbd)

The bluzelle-js version.

```javascript
const {version} = require('bluzelle');

assert(version === '0.6.843'); // your version may be different
```

### bluzelle\({...}\)

Configures the Bluzelle connection. This may be called multiple times to create multiple clients.

```javascript
const {bluzelle} = require('bluzelle');

const api = await bluzelle({
    address: 'bluzelle1xhz23a58mku7ch3hx8f9hrx6he6gyujq57y3kp',
    mnemonic: 'volcano arrest ceiling physical concert sunset absent hungry tobacco canal census era pretty car code crunch inside behind afraid express giraffe reflect stadium luxury',
    endpoint: "http://localhost:1317",
    uuid:     "20fc19d4-7c9d-4b5c-9578-8cedd756e0ea",
    chain_id: "bluzelle"
});
```

{% hint style="info" %}
`bluzelle` and `version`are the only exports of the Bluzelle library. The calls below are methods of the object generated by calling `bluzelle`.
{% endhint %}

| Argument | Description |
| :--- | :--- |
| **address** | The address of your Bluzelle account |
| **mnemonic** | The mnemonic of the private key for your Bluzelle account |
| endpoint | \(Optional\) The hostname and port of your rest server. Default: http://localhost:1317 |
| uuid | \(Optional\) Bluzelle uses `UUID`'s to identify distinct databases on a single swarm. We recommend using [Version 4 of the universally unique identifier](https://en.wikipedia.org/wiki/Universally_unique_identifier#Version_4_%28random%29). Defaults to the account address. |
| chain_id | \(Optional\) The chain id of your Bluzelle account. Default: bluzelle |


## Database Functions

### create\(key, value)

Create a field in the database.

```javascript
// promise syntax
api.create('mykey', '{ a: 13 }').then(() => { ... }, error => { ... });

// async/await syntax
await api.create('mykey', '{ a: 13 }');
```

| Argument | Description |
| :--- | :--- |
| key | The name of the key to create |
| value | The string value to set the key |

Returns a promise resolving to nothing.

Throws an exception when a response is not received from the connection, the key already exists, or invalid value.

### read\(key\)

Retrieve the value of a key.

```javascript
// promise syntax
api.read('mykey').then(value => { ... }, error => { ... });

// async/await syntax
const value = await api.read('mykey');
```

| Argument | Description |
| :--- | :--- |
| key | The key to retrieve |

Returns a promise resolving the string value of the key.

Throws an exception when the key does not exist in the database.

### update\(key, value\[, ttl\]\)

Updates a field in the database.

```javascript
// promise syntax
api.update('mykey', '{ a: 13 }').then(() => { ... }, error => { ... });

// async/await syntax
await api.update('mykey', '{ a: 13 }');
```

| Argument | Description |
| :--- | :--- |
| key | The name of the key to create |
| value | The string value to set the key |

Returns a promise resolving to nothing.

Throws an exception when the key doesn't exist, or invalid value.

### delete\(key\)

Deletes a field from the database.

```javascript
// promise syntax
api.delete('mykey').then(() => { ... }, error => { ... });

// async/await syntax
await bluzelle.delete('mykey');
```

| Argument | Description |
| :--- | :--- |
| key | The name of the key to delete |

Returns a promise resolving to nothing.

Throws an exception when the key is not in the database.

### has\(key\)

Query to see if a key is in the database.

```javascript
// promise syntax
api.has('mykey').then(hasMyKey => { ... }, error => { ... });

// async/await syntax
const hasMyKey = await api.has('mykey');
```

| Argument | Description |
| :--- | :--- |
| key | The name of the key to query |

Returns a promise resolving to a boolean value - `true` or `false`, representing whether the key is in the database.

### keys\(\)

Retrieve a list of all keys.

```javascript
// promise syntax
api.keys().then(keys => { ... }, error => { ... });

// async/await syntax
const keys = await api.keys();
```

Returns a promise resolving to an array of strings. ex. `["key1", "key2", ...]`.

### quickread\(key, prove\)

Retrieve the value of a key without consensus verification. Can optionally require the result to have a cryptographic proof (slower).

```javascript
// promise syntax
api.quickread('mykey').then(value => { ... }, error => { ... });

// async/await syntax
const value = await api.quickread('mykey');
```

| Argument | Description |
| :--- | :--- |
| key | The key to retrieve |
| prove | A proof of the value is required from the network (requires 'config trust-node false' to be set) |

Returns a promise resolving the string value of the key.

Throws an exception when the key does not exist in the database.
Throws an exception when the prove is true and the result fails verification.

### quickhas\(key\)

Query to see if a key is in the database. Has the same interface as 'has' but bypasses the consensus and cryptography mechanisms in favor of speed.


```javascript
// promise syntax
api.has('mykey').then(hasMyKey => { ... }, error => { ... });

// async/await syntax
const hasMyKey = await api.has('mykey');
```

| Argument | Description |
| :--- | :--- |
| key | The name of the key to query |

Returns a promise resolving to a boolean value - `true` or `false`, representing whether the key is in the database. Has the same interface as 'keys' but bypasses the consensus and cryptography mechanisms in favor of speed.

### quickkeys\(\)

Retrieve a list of all keys.

```javascript
// promise syntax
api.keys().then(keys => { ... }, error => { ... });

// async/await syntax
const keys = await api.keys();
```

Returns a promise resolving to an array of strings. ex. `["key1", "key2", ...]`.
